(()=>{"use strict";class e{draw(e,t){const l=document.createElement("div");l.style.margin="100px auto",l.style.display="grid",l.style.justifyContent="center",l.style.height="100%",l.style.gridTemplateColumns="repeat(8, 65px)",e.forEach((e=>{e.forEach((e=>{l.appendChild(e.createCell(t))}))}));const s=document.querySelector("body > div");s&&s.remove(),document.body.appendChild(l)}}class t{index;row;value;element;constructor(e,t,l){this.index=e,this.row=t,this.value=l}createCell(e){return this.element=document.createElement("div"),this.element.style.height="65px",this.element.style.border="1px solid black",this.element.style.display="flex",this.element.style.alignItems="center",this.element.style.justifyContent="center",this.element.style.fontSize="25px",this.element.style.fontWeight="bold",this.element.style.cursor="pointer",this.element.innerHTML=this.value,this.element.addEventListener("click",(()=>e(this))),this.element}}class l{getInitialState(){return Array.from({length:8},((e,l)=>Array.from({length:8},((e,s)=>new t(s,l,this.randomValue())))))}isTransitionValid(e,t){const l=Math.abs(e.row-t.row),s=Math.abs(e.index-t.index);return 1===l&&0===s||0===l&&1===s}getCombinations(e,{row:t,index:l,value:s}){const n=[],a=e[t];let i=[l];for(let e=l-1;e>=0&&a[e].value===s;e--)i.unshift(e);for(let e=l+1;e<8&&a[e].value===s;e++)i.push(e);i.length>=3&&n.push({id:t,type:"row",cellIds:i,bonus:i.length>4});let o=[t];for(let n=t-1;n>=0&&e[n][l].value===s;n--)o.unshift(n);for(let n=t+1;n<8&&e[n][l].value===s;n++)o.push(n);return o.length>=3&&n.push({id:l,type:"column",cellIds:o,bonus:o.length>4}),n}getNormalizedState(e){return e}changeCells(e,t){const l=e.value;e.value=t.value,t.value=l,e.element.innerHTML=e.value,t.element.innerHTML=t.value}randomValue(){return["A","B","C","D","E"][Math.floor(5*Math.random())]}}class s{extendCombinations(e){return e.map((e=>e.cellIds.length>3?{...e,bonus:!0,cellIds:(e.type,Array.from({length:8},((e,t)=>t)))}:e))}}class n{totalScore=0;Statistic;calculate(e){e.forEach((e=>{let t=30+20*(e.cellIds.length-3);this.totalScore+=t,this.Statistic.write({move:`Move ${e.id}`,bonus:e.bonus?"Yes":"No",score:t})}))}}(new class{gameBoard;gameState;bonus=new s;score=new n;selectedCell=null;state=[];constructor(){this.gameBoard=new e,this.gameState=new l}startGame(){this.state=this.gameState.getInitialState(),this.gameBoard.draw(this.state,this.handleCellClick.bind(this))}handleCellClick(e){if(this.selectedCell){if(this.gameState.isTransitionValid(this.selectedCell,e)){this.gameState.changeCells(this.selectedCell,e);let t=this.gameState.getCombinations(this.state,e);t=this.bonus.extendCombinations(t),console.log(t)}this.selectedCell=e}else this.selectedCell=e}}).startGame()})();